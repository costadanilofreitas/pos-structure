# E.g.: ServerRoot "C:/Apache"
ServerRoot "[[SERVER_ROOT]]"

# E.g.: Listen 12.34.56.78:80
Listen [[LISTEN]]

# E.g.: ThreadLimit 64
ThreadLimit [[THREAD_LIMIT]]

# E.g.: ThreadsPerChild 64
ThreadsPerChild [[THREADS_PER_CHILD]]

# E.g.: ServerAdmin example@example.com
ServerAdmin [[SERVER_ADMIN]]

# E.g.: ServerName www.mwneo.com:8080
ServerName [[SERVER_NAME]]

# E.g.: DocumentRoot "C:/Apache/htdocs"
DocumentRoot "[[DOCUMENT_ROOT]]"

# Avoid trying to restart after 10000 requests
MaxRequestsPerChild 0

# Avoid using System V semaphores (and keeping stale O.S. resources at finalization)
# AcceptMutex "flock"

# The configuration bellow is only applied to apache compiled with MPM "worker"
<IfModule mpm_worker_module>
	# This must be always "1", or more than one apache worker is started
	# and mod_mwapp will not run correctly
	StartServers 1

	# E.g.: MaxClients 64
	# This must be exactly the same of "ThreadLimit" value, or more than
	# one apache worker will be started and mod_mwapp will not run correctly
	MaxClients [[THREAD_LIMIT]]
</IfModule>

LoadModule actions_module modules/mod_actions.so
LoadModule alias_module modules/mod_alias.so
LoadModule asis_module modules/mod_asis.so
LoadModule auth_basic_module modules/mod_auth_basic.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authn_file_module modules/mod_authn_file.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule autoindex_module modules/mod_autoindex.so
LoadModule dir_module modules/mod_dir.so
LoadModule env_module modules/mod_env.so
LoadModule include_module modules/mod_include.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule mime_module modules/mod_mime.so
LoadModule negotiation_module modules/mod_negotiation.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule headers_module modules/mod_headers.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule status_module modules/mod_status.so
LoadModule mwapp_module modules/mod_mwapp.so

# Ensure that static content is cacheable, even when SSL and/or authentication is ON
<FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|swf)$">
    Header set Cache-Control "public"
</FilesMatch>

# Ensure that scripts are not cacheable
<FilesMatch "\.(js|css)$">
    Header set Cache-Control "no-cache"
</FilesMatch>

<Directory />
  Options Indexes FollowSymLinks
  AllowOverride None
  Order allow,deny
  Allow from all
</Directory>
<Location /mwapp>
  SetHandler mod_mwapp
  Options None
  Order allow,deny
  Allow from all
</Location>
<Directory "[[DOCUMENT_ROOT]]">
  Options Indexes FollowSymLinks
  AllowOverride None
  Order allow,deny
  Allow from all
</Directory>
<Location /server-status>
  SetHandler server-status
  Order Allow,Deny
  Allow from all
</Location>

ExtendedStatus On

[[ADDITIONAL_FOLDERS]]

<IfModule dir_module>
    DirectoryIndex index.html
</IfModule>

<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

ErrorLog "[[HVDATADIR]]/logs/mwpos_httpd_error.log"
LogLevel info

<IfModule log_config_module>
    LogFormat "%h %l %u %t \"%r\" %>s %b %D %X \"%{Referer}i\" \"%{User-Agent}i\"" combined
    LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b %D %X \"%{Referer}i\" \"%{User-Agent}i\"" proxy
    SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded
    CustomLog "[[HVDATADIR]]/logs/mwpos_httpd_access.log" proxy env=forwarded
    SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" dontlog

    SetEnvIf Request_URI "^/monitor/status\.html$" dontlog
    SetEnvIf Request_URI "^/server-status$" dontlog
    CustomLog "[[HVDATADIR]]/logs/mwpos_httpd_access.log" combined env=!dontlog
</IfModule>

DefaultType text/plain

<IfModule mime_module>
    TypesConfig conf/mime.types
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz
</IfModule>

EnableMMAP on
EnableSendfile on

KeepAlive On
MaxKeepAliveRequests 5
KeepAliveTimeout 1

